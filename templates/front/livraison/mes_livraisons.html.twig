{% extends 'base.html.twig' %}

{% block title %}Mes Livraisons - PackTrack{% endblock %}

{% block stylesheets %}
<style>
    .container {
        max-width: 1200px;
        margin: 40px auto;
        padding: 20px;
    }
    
    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
    }
    
    .btn {
        padding: 12px 24px;
        background: #007bff;
        color: white;
        text-decoration: none;
        border-radius: 8px;
        font-weight: 600;
    }
    
    .livraison-table {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
    }
    
    th {
        background: #f8f9fa;
        padding: 16px;
        text-align: left;
        font-weight: 600;
        border-bottom: 2px solid #dee2e6;
    }
    
    td {
        padding: 16px;
        border-bottom: 1px solid #dee2e6;
    }
    
    .badge {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
    }
    
    .badge.en_cours {
        background: #d1ecf1;
        color: #0c5460;
    }
    
    .badge.termine {
        background: #d4edda;
        color: #155724;
    }
    
    .btn-finish {
        padding: 8px 16px;
        background: #28a745;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 13px;
    }
    
    .btn-finish:hover {
        background: #218838;
    }
    .badge {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
    }


    .btn-info-icon {
    color: #17a2b8;
    text-decoration: none;
    font-size: 18px;
    margin-right: 10px;
    transition: transform 0.2s;
    display: inline-block;
    }

    .btn-info-icon:hover {
        transform: scale(1.2);
    }
    
    
</style>
{% endblock %}

{% block body %}
<div class="container">
    {% for message in app.flashes('success') %}
        <div class="alert alert-success">‚úÖ {{ message }}</div>
    {% endfor %}

    <div class="page-header">
        <h1>üìã Mes Livraisons</h1>
        <a href="{{ path('app_livraison_index') }}" class="btn">üîç Voir colis disponibles</a>
    </div>

    <div class="livraison-table">
        <table>
            <thead>
                <tr>
                    <th>#ID</th>
                    <th>Colis</th>
                    <th>Destination</th>
                    <th>Poids</th>
                    <th>Date d√©but</th>
                    <th>Distance</th>
                    <th>Total</th>
                    <th>Statut</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                {% for livraison in livraisons %}
                <tr>
                    <td>#{{ livraison.id }}</td>
                    <td>#{{ livraison.colis.id }}</td>
                    <td>{{ livraison.colis.adresseDestination|slice(0, 40) }}...</td>
                    <td>{{ livraison.colis.poids ? livraison.colis.poids ~ ' kg' : 'N/A' }}</td>
                    <td>{{ livraison.dateDebut|date('d/m/Y H:i') }}</td>
                    <td>
                        {% if livraison.distanceKm %}
                            <strong>{{ livraison.distanceKm }} km</strong>
                        {% else %}
                            <span style="color: #6c757d;">-</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if livraison.total %}
                            <strong style="color: #28a745;">{{ livraison.total|number_format(2, ',', ' ') }} ‚Ç¨</strong>
                        {% else %}
                            <span style="color: #6c757d;">-</span>
                        {% endif %}
                    </td>
                    <td>
                        <span class="badge {{ livraison.statut }}">
                            {{ livraison.statut|replace({'_': ' '})|title }}
                        </span>
                    </td>
                    <td>
                        <a href="{{ path('app_livraison_details', {id: livraison.id}) }}" 
                        class="btn-info-icon" 
                        title="Voir les d√©tails">
                            ‚ÑπÔ∏è
                        </a>
                        {% if livraison.statut == 'en_cours' %}
                            <a href="{{ path('app_livraison_terminer', {id: livraison.id}) }}" class="btn-finish">
                                ‚úÖ Terminer
                            </a>
                        {% else %}
                            <span style="color: #28a745;">‚úì Termin√©e</span>
                        {% endif %}
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="9" style="text-align: center; padding: 40px; color: #6c757d;">
                        Aucune livraison pour le moment.
                    </td>
                </tr>
                {% endfor %}
                </tbody>
        </table>
    </div>
</div>
{% endblock %}